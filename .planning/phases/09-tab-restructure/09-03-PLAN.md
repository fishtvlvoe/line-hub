---
wave: 3
depends_on:
  - 09-02
files_modified: []
autonomous: true
requirements:
  - TAB-05
---

# Plan 09-03: 整合驗證

**目標：** 驗證所有 5 Tab 正常運作、form 隔離正確、舊 URL redirect 有效、現有功能未被破壞。

## Tasks

<task id="1">
  <objective>驗證所有檔案語法正確</objective>
  <files>
    includes/admin/class-settings-page.php
    includes/admin/tabs/*.php
    includes/admin/views/*.php
  </files>
  <action>
    對所有修改過的 PHP 檔案執行 php -l 語法檢查
  </action>
  <verify>所有檔案 php -l 通過，無 syntax error</verify>
  <done>false</done>
</task>

<task id="2">
  <objective>驗證主類別行數 < 200</objective>
  <files>includes/admin/class-settings-page.php</files>
  <action>
    wc -l 確認主類別行數不超過 200 行
  </action>
  <verify>行數 < 200</verify>
  <done>false</done>
</task>

<task id="3">
  <objective>驗證 Tab 類別結構完整</objective>
  <files>includes/admin/tabs/</files>
  <action>
    確認以下檔案都存在且有正確的類別定義：
    - class-abstract-tab.php（AbstractTab）
    - class-wizard-tab.php（WizardTab）
    - class-line-settings-tab.php（LineSettingsTab）
    - class-login-settings-tab.php（LoginSettingsTab）
    - class-webhook-tab.php（WebhookTab）
    - class-developer-tab.php（DeveloperTab）
  </action>
  <verify>6 個檔案都存在，每個都有正確的 class 定義和 namespace</verify>
  <done>false</done>
</task>

<task id="4">
  <objective>驗證 View 檔案對應正確</objective>
  <files>includes/admin/views/</files>
  <action>
    確認以下 view 檔案存在：
    - tab-wizard.php
    - tab-line-settings.php
    - tab-login-settings.php
    - tab-webhook.php
    - tab-developer.php
    - partials/connection-status.php
    確認舊檔案已清理：
    - tab-settings.php（已刪除或重命名）
    - tab-login.php（已刪除或重命名）
  </action>
  <verify>新 view 存在，舊 view 已清理</verify>
  <done>false</done>
</task>

<task id="5">
  <objective>驗證 form 隔離和 nonce 結構</objective>
  <files>includes/admin/views/tab-*.php</files>
  <action>
    檢查每個有 form 的 view：
    1. tab-line-settings.php：form hidden tab='line-settings'
    2. tab-login-settings.php：form hidden tab='login-settings'
    3. tab-wizard.php：無 form（只讀）
    4. tab-webhook.php：無 form（只讀）
    5. tab-developer.php：API Key form 使用獨立 nonce
  </action>
  <verify>form hidden field 的 tab 值與 Tab slug 一致</verify>
  <done>false</done>
</task>

<task id="6">
  <objective>建立 SUMMARY.md</objective>
  <files>.planning/phases/09-tab-restructure/09-SUMMARY.md</files>
  <action>
    建立 Phase 9 完成摘要，包含：
    - 完成的需求（TAB-01~05）
    - 檔案變更清單
    - 行數統計
    - Success Criteria 達成狀態
  </action>
  <verify>SUMMARY.md 存在</verify>
  <done>false</done>
</task>

## must_haves

truths:
  - 所有 PHP 檔案 php -l 通過
  - 主類別 < 200 行
  - 5 Tab 結構完整
  - form 隔離正確（各 Tab 獨立 form + 正確的 tab hidden field）
  - 舊 slug redirect 邏輯存在

key_links:
  - includes/admin/class-settings-page.php
  - includes/admin/tabs/
  - includes/admin/views/
